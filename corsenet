# Define output shape for ori_highest_peak
def compute_output_shape_ori_highest_peak(input_shape):
    # Example: Keeps height and width same, reduces channels to 1
    return input_shape[:-1] + (1,)

# Define output shape for select_max
def compute_output_shape_select_max(input_shape):
    # Example: Keeps the same shape as the input
    return input_shape

# Modify Lambda layers
ori_peak = Lambda(ori_highest_peak, output_shape=compute_output_shape_ori_highest_peak)(ori_out_1)
ori_peak = Lambda(select_max, output_shape=compute_output_shape_select_max)(ori_peak)
